{% extends 'base.html' %}

{% block title %}Account List{% endblock %}

{% block content %}
<h2>Account name: {{ account.name }} ( {{ account.account_id }} )</h2>

{% with messages = get_flashed_messages(with_categories=True) %}
{% if messages %}
<div class="mt-3">
    {% for category, message in messages %}
    <div class="alert alert-{{ category }}" id="flash-message">{{ message }}</div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}

<form method="POST" action="{{ url_for('add_region', account_id=account.id) }}" class="d-flex">
    <select class="form-control rounded-0 me-2" name="region_name" required>
        <option value="" disabled selected>Select a Region to add</option>
        {% for region in regions %}
        <option value="{{ region }}">{{ region }}</option>
        {% endfor %}
    </select>
    <button type="submit" class="btn btn-primary rounded-0">Add Region</button>
</form>

<h2>Regions</h2>

<div class="row row-cols-1 row-cols-md-4 g-4" style="max-height: 900px; overflow-y: auto;">
    {% for region in account.regions %}
    <div class="col">
        <div class="card border-success p-3  rounded-0">
            <a href="{{ url_for('region_detail', account_id=account.id, region_id=region.id) }}">{{ region.name }}</a>
        </div>
    </div>
    {% endfor %}
</div>

<a href="{{ url_for('index') }}" class="btn btn-primary rounded-0 mt-3">Back to Home</a>

<script>
    // Wait for the DOM to load
    document.addEventListener("DOMContentLoaded", function() {
        // Get all flash messages
        const flashMessages = document.querySelectorAll('.alert');
        flashMessages.forEach(message => {
            // Set a timeout to fade out each message after 1 second
            setTimeout(() => {
                message.style.transition = 'opacity 0.2s ease'; // Fade-out transition
                message.style.opacity = 0; // Start fade out
                setTimeout(() => {
                    message.remove(); // Remove the message from the DOM after fading out
                }, 400); // Wait for fade-out to finish
            }, 500); // Wait 1 second before starting to fade out
        });
    });
</script>

{% endblock %}